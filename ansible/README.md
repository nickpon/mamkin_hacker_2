# 4-ая и 5-ая лабораторные работы.
## Пономаренко Николай Дмитриевич, 692

0. Настройка ssh соединения с серверами.

   На сервера нужно прокинуть ssh-ключи, после чего настроить удобное
   беспарольное соединение.

1. Запуск приложения в чистой среде.
    
    Удаляются все предыдущие койтейнеры для данных сервисов,
    удаляются все предыдущие images для данных сервисов,
    заново делается чистый mvn package для каждого сервиса,
    заново делается docker build для каждого сервиса,
    после чего делается docker save образа для дальнейшей загрузки на сервер.
    
    Далее выполняется деплой сервисов на два сервера.
    На каждом из серверов пересоздаётся папка с ресурсами, удаляются 
    абсолютно все контейнеры и образы докера на каждом из серверов.
    После чего через docker-compose запускаются все четыре сервиса.
    Стоит ометить, что информация о паролях и логинах для 
    серверов передаётся секьюрно (для начала стадии деплоя нужно
    ввести пароль `iamthebest`).
    
    `bash ansible-run.sh`.

2. Проверка работоспособности приложения.

    2.1. Сервис hello.
    
    `http://localhost:8084/` - выдаёт "Hello, user! This seems to be initial page!"
    
    2.2. Сервис rbc.
    
    `http://localhost:8083/rbc` - максимальный курс доллара США 
    по отношению к рублю за 30 рабочих дней. Результат кэшируется в БД.
    
    `http://localhost:8083/rbc/array` - вывод массива 'курс=UNIXTime' за 30 дней, разделённых запятыми.
    
    2.3 Сервис weather.
    
    `http://localhost:8081/weather?time=<your_UNIXTime>` - выводит температуру в Москве в `<your_UNIXTime>` (например, `1584651600`) момент времени.
    
    `http://localhost:8081/weather/array` - вывод массива 'температура в Москве=UNIXTime' за 50 дней, разделённых запятыми.
    
    2.4 Сервис prediction.
    
    `http://localhost:8082/prediction?temperature=<your_temperature>` - вывод предсказание курса доллара США по
    отношению к курсу рубля относительно температуры `<your_temperature>` (например, `2.71`). 
    Для этого делается следующее: от сервиса rbc берётся массив 'курс=UNIXTime' за 30 дней,
    от сервиса weather берётся массив 'температура в Москве=UNIXTime' за 50 дней 
    (так как биржа не работает каждый день, а погода измеряется каждый день),
    находятся соответствия 'курс=температура в Москве' по UNIXTime, с помощью метода наименьших
    квадратов строится прямая, задаваемая коэффициентами A и B, 
    далее предсказание считается по следующей формуле: `A + <your_temperature> * B`.